// Service worker background script for Pentest Recon+

chrome.runtime.onInstalled.addListener(() => {
  console.log("Pentest Recon+ extension installed.");
});

// Listen for completed web requests and log details
chrome.webRequest.onCompleted.addListener(
  (details) => {
      console.log("Request completed:", details);
      if (details.type === "xmlhttprequest" || details.type === "main_frame") {
          chrome.storage.local.get({ requests: [] }, (result) => {
              const updatedRequests = result.requests;
              updatedRequests.push({
                  url: details.url,
                  method: details.method,
                  statusCode: details.statusCode,
                  type: details.type,
                  timeStamp: new Date(details.timeStamp).toLocaleString()
              });
              chrome.storage.local.set({ requests: updatedRequests });
          });
      }
  },
  { urls: ["<all_urls>"] }
);
